<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Bajo el Mar - M√°s all√° del algoritmo</title>
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Prata&display=swap"
            rel="stylesheet"
        />
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
            crossorigin="anonymous"
        />
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
            crossorigin="anonymous"
        />
        <link rel="stylesheet" href="./styles.css" />
    </head>
    <body>
        <header>
            <div class="container-header">
                <a href="./index.html" class="logo">
                    <h1>Bajo el Mar: M√°s all√° del algoritmo</h1>
                </a>
                <nav>
                    <ul>
                        <li>
                            <a href="./index.html" class="active">Inicio</a>
                        </li>
                        <li>
                            <a href="./biodiversidad.html">Biodiversidad</a>
                        </li>
                        <li><a href="./galeria.html">Galer√≠a</a></li>
                        <li><a href="./multimedia.html">Multimedia</a></li>
                        <li><a href="./playlist.html">Playlist</a></li>
                            <a href="./linea_tiempo.html">L√≠nea de Tiempo</a>
                        </li>
                    </ul>
                </nav>
            </div>
        </header>

        <!-- ====== PRESENTACI√ìN ====== -->
        <section id="presentacion">
            <video autoplay muted loop id="videoFondo">
                <source src="./assets/videoInicio.mp4" type="video/mp4" />
            </video>

            <div class="overlay"></div>

            <div class="contenido">
                <h2>UNA MIRADA CR√çTICA SOBRE LA CIENCIA Y LA TECNOLOG√çA</h2>
                <p>
                    <strong>Bajo el mar, m√°s all√° del algoritmo</strong> es un
                    proyecto interdisciplinario que articula saberes t√©cnicos
                    del campo del An√°lisis de Sistemas con perspectivas de
                    Ciencia, Tecnolog√≠a y Sociedad (CTS), ESI y Culturas
                    Digitales. <br /><br />
                    Inspirado en el archivo transmedia del CONICET sobre el Mar
                    Argentino, invita a reflexionar sobre c√≥mo la tecnolog√≠a
                    produce sentidos, emociones y narrativas colectivas.
                </p>

                <blockquote>
                    ‚ÄúLa tecnolog√≠a no es un instrumento neutro, sino una
                    construcci√≥n social.‚Äù
                    <span>‚Äî Raymond Williams (1992)</span>
                </blockquote>

                <a href="./galeria.html" class="btn">Explor√° la experiencia</a>
            </div>
        </section>

        <section id="spotify-section" class="text-center my-5">
            <h2>üéß Conect√° con Spotify</h2>
            <p>Inici√° sesi√≥n para descubrir la playlist ‚ÄúBajo el Mar‚Äù.</p>
            <button id="login" class="btn btn-success">Iniciar sesi√≥n con Spotify</button>
        </section>

        <footer>
            <p>
                ¬© 2025 Proyecto interdisciplinario CTS | Estuadiantes Analistas
                de Sistemas
            </p>
        </footer>
    </body>
        <script>
        const clientId = '5c33b10c84a54669964ad19c1f99894a';
const redirectUri = 'https://lautaro-ruspil.github.io';
const scope = 'user-read-private user-read-email playlist-read-private playlist-modify-public';

// üîê Funci√≥n para generar el c√≥digo PKCE
function generateCodeVerifier(length) {
  let text = '';
  const possible = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
  for (let i = 0; i < length; i++) {
    text += possible.charAt(Math.floor(Math.random() * possible.length));
  }
  return text;
}

async function generateCodeChallenge(codeVerifier) {
  const data = new TextEncoder().encode(codeVerifier);
  const digest = await crypto.subtle.digest('SHA-256', data);
  return btoa(String.fromCharCode(...new Uint8Array(digest)))
    .replace(/\+/g, '-')
    .replace(/\//g, '_')
    .replace(/=+$/, '');
}

document.getElementById('login').addEventListener('click', async () => {
  const codeVerifier = generateCodeVerifier(128);
  const codeChallenge = await generateCodeChallenge(codeVerifier);

  localStorage.setItem('code_verifier', codeVerifier);

  const authUrl = `https://accounts.spotify.com/authorize?client_id=${clientId}&response_type=code&redirect_uri=${encodeURIComponent(
    redirectUri
  )}&scope=${encodeURIComponent(scope)}&code_challenge_method=S256&code_challenge=${codeChallenge}`;

  window.location.href = authUrl;
});

// üéØ Cuando vuelve Spotify con el "code" en la URL
window.addEventListener('load', async () => {
  const params = new URLSearchParams(window.location.search);
  const code = params.get('code');

  if (code) {
    const codeVerifier = localStorage.getItem('code_verifier');

    const body = new URLSearchParams({
      client_id: clientId,
      grant_type: 'authorization_code',
      code,
      redirect_uri: redirectUri,
      code_verifier: codeVerifier
    });

    const response = await fetch('https://accounts.spotify.com/api/token', {
      method: 'POST',
      headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
      body
    });

    const data = await response.json();
    console.log('Token recibido:', data.access_token);
    localStorage.setItem('spotify_token', data.access_token);
  }
});

   
    </script>
</html>
